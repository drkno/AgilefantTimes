<link rel="import" href="bower_components/core-signals/core-signals.html">
<link rel="import" href="bower_components/chart-elements/chart-elements.html">

<polymer-element name="data-charts" attributes="labels data">

    <template>
        <style>
            :host {
                width: 100%;
                height: 100%;
                box-sizing: border-box;
            }


        </style>

        <core-signals on-core-signal-new-chartdata="{{newData}}"></core-signals>
        <div  horizontal layout center-justified>
            <chart-pie
                    width="200"
                    height="200"
                    values="{{chartValues[0]}}">
            </chart-pie>
            <chart-doughnut
                    width="200"
                    height="200"
                    values="{{chartValues[0]}}">
            </chart-doughnut>
            <chart-polar-area
                    width="200"
                    height="200"
                    values="{{chartValues[0]}}">
            </chart-polar-area>
            <chart-radar
                    width="300"
                    height="300"
                    labels="{{chartLabels}}"
                    values="{{chartValues}}"
                    colors="['3, 169, 244']">
            </chart-radar>
        </div>
        <div horizontal layout center-justified>
            <chart-line
                    width="600"
                    height="250"
                    labels="{{chartLabels}}"
                    values="{{chartValues}}"
                    colors="['3, 169, 244']">
            </chart-line>
            <chart-bar
                width="600"
                height="250"
                labels="{{chartLabels}}"
                values="{{chartValues}}"
                colors="['3, 169, 244']">
            </chart-bar>
        </div>


    </template>

    <script>
        Polymer('data-charts', {
            userData: [],
            chartLabels: [],
            chartValues: [[]],
            ready: function() {
            },

            /**
             * Rounds a number to 1dp or less.
             * @param number number to round.
             * @returns number rounded to 1dp or less.
             */
            roundup1dp: function(number) {
                return +(Math.round(number + "e+1") + "e-1");
            },

            newData: function(e, detail, sender) {
                var newChartLabels = [],
                        newChartValues = [[]],
                        i = 0;
                this.userData = detail;
                for (i; i < detail.length; i++) {
                    newChartLabels[i] = detail[i].Name;
                    newChartValues[0][i] = this.roundup1dp(detail[i].TotalHours);
                }
                this.chartLabels = newChartLabels;
                this.chartValues = newChartValues;
            }
        });
    </script>
</polymer-element>